---
title: "Understanding Employee Attrition: Data-Driven Insights"
author: ""
date: ""
format: 
  html:
    page-layout: full
    include-after-body: abbrv_toc.html
    number-sections: true
toc: true
toc-depth: 2
toc-title: Contents
---
This analysis focuses on employee attrition using data from the [*IBM HR Analytics Employee Attrition & Performance*](https://www.kaggle.com/datasets/pavansubhasht/ibm-hr-analytics-attrition-dataset). It explores possible reasons why employees leave their jobs and the process used to identify these insights. The examples provided illustrate key factors influencing attrition, but in a real-world setting, a more comprehensive analysis would be necessary. 

## The Role of Age in Employee Attrition: Trends and Insights {toc-text="Age"}
```{r}
#| output: false
#| include: false
#| warning: false

library(tidyverse)
library(janitor)
library(ggpattern)
library(here)
library(patchwork)


ibm_data <- read_csv(here("ibm_dataset","ibm_dataset.csv")) |> 
  clean_names()
```


> What is the distribution of age?

Visualizing the age distribution to identify natural groupings for analysis.
```{r}
#| echo: false
#| warning: false

p1 <- ggplot(ibm_data, aes(x = age)) +
  geom_histogram(fill = "#0066CC", color = "#e9ecef", alpha = 0.9) +
  stat_bin(aes(label = after_stat(count)), geom = "text", color = "white", vjust = 1.5, size = 3) +
  theme_minimal() +
  theme(panel.grid.major = element_blank(),     
        panel.grid.minor = element_blank()) +   
  labs(title = "Age Distribution of Employees")
p1
```


```{r}
#| echo: false

# Modify data
# added two columns, (1) was re-coding 0 and 1 into quit and not quit, (2) group aged into groups
ibm_data <- ibm_data |> 
  mutate(
    quit_status = ifelse(attrition == 1, "Quit", "Retained"),
    age_group = factor(cut(age, 
                           breaks = c(18, 25, 35, 45, 55, 65), 
                           labels = c("18-25", "26-35", "36-45", "46-55", "56-65"),
                           right = FALSE))
  )

```




```{r}
#| echo: false
#| warning: false
# Number of Employees Who Quit vs. Stayed Across Age Groups


p2 <- ggplot(ibm_data, aes(x = age_group, fill = factor(quit_status))) + 
  geom_bar(position = "dodge", alpha = 0.9) + 
  geom_text(stat = "count", aes(label = after_stat(count)), 
            position = position_dodge(width = 0.9), vjust = -0.5) +  
  scale_fill_manual(values = c("Retained" = "#0066CC", "Quit" = "orange"), 
                    labels = c("Retained", "Quit")) +  
  labs(
    x = "Age Group", 
    y = "Number of Employees", 
    fill = "Quit Status",
      ) +
  theme_minimal() +
  theme(panel.grid.major = element_blank(),     
        panel.grid.minor = element_blank()) 
      

# Quit and Retention Percentages by Age Group (Stacked + percent)
p3 <- ggplot(ibm_data, aes(x = age_group, fill = quit_status)) + 
  geom_bar(position = "fill", alpha=0.9, show.legend = FALSE) + 
  scale_y_continuous(labels = scales::percent) + 
  scale_fill_manual(values = c("Retained" = "#0066CC", "Quit" = "#FF9900"), 
                    labels = c("Retained", "Quit")) + 
  labs(x = "Age Group", y = "Percentage", fill = "Quit Status") +
  theme_minimal() +
  theme(panel.grid.major = element_blank(),     
        panel.grid.minor = element_blank()) 



(p2 | p3) + 
  plot_annotation(
    title = "Number of Employees Who Quit vs. Retained",
    theme = theme(plot.title = element_text(hjust = 0.5))
  ) +
  plot_layout(guides = "collect") & 
  theme(legend.position = "top")


```


## Education {toc-text="Education"}

